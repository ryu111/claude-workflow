#!/bin/bash
# agent-status-display.sh - Agent å•Ÿå‹•è¦–è¦ºç¢ºèª
# äº‹ä»¶: SubagentStart
# åŠŸèƒ½: ç•¶ Agent å•Ÿå‹•æ™‚é¡¯ç¤ºå³æ™‚ç¢ºèªçµ¦ç”¨æˆ¶
# 2025 AI Guardrails: User Notification Pattern

# DEBUG
echo "[$(date)] agent-status-display.sh called (SubagentStart)" >> /tmp/claude-workflow-debug.log

# è®€å– stdin çš„ JSON è¼¸å…¥
INPUT=$(cat)
echo "[$(date)] SubagentStart INPUT: $INPUT" >> /tmp/claude-workflow-debug.log

# è§£æ Agent åç¨±ï¼ˆæ ¼å¼ï¼šclaude-workflow:developerï¼‰
RAW_AGENT_NAME=$(echo "$INPUT" | jq -r '.agent_name // empty' | tr '[:upper:]' '[:lower:]')
# ç§»é™¤ plugin å‰ç¶´
AGENT_NAME=$(echo "$RAW_AGENT_NAME" | sed 's/.*://')

# è§£æä»»å‹™æè¿°
DESCRIPTION=$(echo "$INPUT" | jq -r '.description // empty')

echo "[$(date)] AGENT_NAME: $AGENT_NAME, DESCRIPTION: $DESCRIPTION" >> /tmp/claude-workflow-debug.log

# å¦‚æœæ²’æœ‰ agent åç¨±ï¼Œç›´æ¥é€€å‡º
if [ -z "$AGENT_NAME" ]; then
    exit 0
fi

# æ ¹æ“š Agent é¡å‹é¡¯ç¤ºä¸åŒçš„å•Ÿå‹•è¨Šæ¯
# æ³¨æ„ï¼šSubagentStart çš„ stderr æœƒé¡¯ç¤ºçµ¦ç”¨æˆ¶
case "$AGENT_NAME" in
    developer)
        echo "" >&2
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" >&2
        echo "â•‘                    ğŸ’» DEVELOPER å•Ÿå‹•                            â•‘" >&2
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" >&2
        if [ -n "$DESCRIPTION" ]; then
            echo "ğŸ“‹ ä»»å‹™: $DESCRIPTION" >&2
        fi
        echo "ğŸ“š Skills: drt-rules, development, ui-design, checkpoint" >&2
        echo "ğŸ’¡ å®Œæˆå¾Œéœ€è¦ REVIEWER å¯©æŸ¥" >&2
        echo "" >&2
        ;;

    reviewer)
        echo "" >&2
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" >&2
        echo "â•‘                    ğŸ” REVIEWER å•Ÿå‹•                             â•‘" >&2
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" >&2
        if [ -n "$DESCRIPTION" ]; then
            echo "ğŸ“‹ ä»»å‹™: $DESCRIPTION" >&2
        fi
        echo "ğŸ“š Skills: drt-rules, code-review" >&2
        echo "ğŸ”’ å”¯è®€æ¨¡å¼ï¼šåƒ…å¯ä½¿ç”¨ Read, Glob, Grep" >&2
        echo "" >&2
        ;;

    tester)
        echo "" >&2
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" >&2
        echo "â•‘                    ğŸ§ª TESTER å•Ÿå‹•                               â•‘" >&2
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" >&2
        if [ -n "$DESCRIPTION" ]; then
            echo "ğŸ“‹ ä»»å‹™: $DESCRIPTION" >&2
        fi
        echo "ğŸ“š Skills: drt-rules, test, error-handling" >&2
        echo "ğŸ§° å·¥å…·ï¼šRead, Glob, Grep, Bash" >&2
        echo "" >&2
        ;;

    debugger)
        echo "" >&2
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" >&2
        echo "â•‘                    ğŸ› DEBUGGER å•Ÿå‹•                             â•‘" >&2
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" >&2
        if [ -n "$DESCRIPTION" ]; then
            echo "ğŸ“‹ ä»»å‹™: $DESCRIPTION" >&2
        fi
        echo "" >&2
        ;;

    architect)
        echo "" >&2
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" >&2
        echo "â•‘                    ğŸ—ï¸ ARCHITECT å•Ÿå‹•                            â•‘" >&2
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" >&2
        if [ -n "$DESCRIPTION" ]; then
            echo "ğŸ“‹ ä»»å‹™: $DESCRIPTION" >&2
        fi
        echo "" >&2
        ;;

    designer)
        echo "" >&2
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" >&2
        echo "â•‘                    ğŸ¨ DESIGNER å•Ÿå‹•                             â•‘" >&2
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" >&2
        if [ -n "$DESCRIPTION" ]; then
            echo "ğŸ“‹ ä»»å‹™: $DESCRIPTION" >&2
        fi
        echo "" >&2
        ;;

    explorer|explore)
        echo "" >&2
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" >&2
        echo "â•‘                    ğŸ”­ EXPLORER å•Ÿå‹•                             â•‘" >&2
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" >&2
        if [ -n "$DESCRIPTION" ]; then
            echo "ğŸ“‹ ä»»å‹™: $DESCRIPTION" >&2
        fi
        echo "" >&2
        ;;

    planner|plan)
        echo "" >&2
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" >&2
        echo "â•‘                    ğŸ“‹ PLANNER å•Ÿå‹•                              â•‘" >&2
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" >&2
        if [ -n "$DESCRIPTION" ]; then
            echo "ğŸ“‹ ä»»å‹™: $DESCRIPTION" >&2
        fi
        echo "" >&2
        ;;

    main)
        echo "" >&2
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" >&2
        echo "â•‘                    ğŸ¤– MAIN å•Ÿå‹•                                 â•‘" >&2
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" >&2
        if [ -n "$DESCRIPTION" ]; then
            echo "ğŸ“‹ ä»»å‹™: $DESCRIPTION" >&2
        fi
        echo "" >&2
        ;;

    general-purpose)
        echo "" >&2
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" >&2
        echo "â•‘                    ğŸ”§ GENERAL-PURPOSE å•Ÿå‹•                      â•‘" >&2
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" >&2
        if [ -n "$DESCRIPTION" ]; then
            echo "ğŸ“‹ ä»»å‹™: $DESCRIPTION" >&2
        fi
        echo "" >&2
        ;;

    *)
        # å…¶ä»– agent ä¹Ÿé¡¯ç¤ºå¤§æ¡†
        echo "" >&2
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" >&2
        echo "â•‘                    ğŸ“‹ $AGENT_NAME å•Ÿå‹•" >&2
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" >&2
        if [ -n "$DESCRIPTION" ]; then
            echo "ğŸ“‹ ä»»å‹™: $DESCRIPTION" >&2
        fi
        echo "" >&2
        ;;
esac

# SubagentStart ä¸éœ€è¦è¼¸å‡º JSON decision
exit 0
